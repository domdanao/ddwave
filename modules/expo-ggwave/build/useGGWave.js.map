{"version":3,"file":"useGGWave.js","sourceRoot":"","sources":["../src/useGGWave.ts"],"names":[],"mappings":"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","sourcesContent":["import { useState, useEffect, useCallback } from 'react';\nimport GGWave, { GGWaveProtocol, GGWaveConfig } from './index';\nimport { requireNativeModule, EventEmitter } from 'expo-modules-core';\nimport { GGWaveAudioLevelEvent, GGWaveDataReceivedEvent } from './ExpoGGWave.types';\n\ntype GGWaveEventMap = {\n  onDataReceived: (event: GGWaveDataReceivedEvent) => void;\n  onAudioLevel: (event: GGWaveAudioLevelEvent) => void;\n};\n\nconst ExpoGGWaveModule = requireNativeModule('ExpoGGWave');\nconst emitter = new EventEmitter<GGWaveEventMap>(ExpoGGWaveModule as any);\n\nexport interface ReceivedMessage {\n  text: string;\n  timestamp: number;\n}\n\ninterface UseGGWaveConfig extends GGWaveConfig {\n  // Additional hook-specific config can go here\n}\n\nexport function useGGWave(config?: UseGGWaveConfig) {\n  const [isInitialized, setIsInitialized] = useState(false);\n  const [isListening, setIsListening] = useState(false);\n  const [receivedMessages, setReceivedMessages] = useState<ReceivedMessage[]>([]);\n  const [audioLevel, setAudioLevel] = useState({ rms: 0, peak: 0 });\n  const [subscription, setSubscription] = useState<{ remove: () => void } | null>(null);\n  const [audioLevelSubscription, setAudioLevelSubscription] = useState<{ remove: () => void } | null>(null);\n\n  useEffect(() => {\n    GGWave.initialize(config).then(() => setIsInitialized(true));\n  }, []);\n\n  const transmit = useCallback(async (\n    text: string,\n    protocol?: GGWaveProtocol,\n    volume?: number\n  ) => {\n    await GGWave.transmit(text, protocol, volume);\n  }, []);\n\n  const startListening = useCallback(async () => {\n    const sub = await GGWave.startListening((text) => {\n      setReceivedMessages(prev => [...prev, { text, timestamp: Date.now() }]);\n    });\n    setSubscription(sub);\n\n    // Subscribe to audio level events for visualization\n    const audioSub = emitter.addListener('onAudioLevel', (event: GGWaveAudioLevelEvent) => {\n      setAudioLevel({ rms: event.rms, peak: event.peak });\n    });\n    setAudioLevelSubscription(audioSub);\n\n    setIsListening(true);\n  }, []);\n\n  const stopListening = useCallback(async () => {\n    if (subscription) {\n      subscription.remove();\n      setSubscription(null);\n    }\n    if (audioLevelSubscription) {\n      audioLevelSubscription.remove();\n      setAudioLevelSubscription(null);\n    }\n    await GGWave.stopListening();\n    setIsListening(false);\n    setAudioLevel({ rms: 0, peak: 0 });\n  }, [subscription, audioLevelSubscription]);\n\n  const clearMessages = useCallback(() => {\n    setReceivedMessages([]);\n  }, []);\n\n  return {\n    isInitialized,\n    isListening,\n    receivedMessages,\n    audioLevel,\n    transmit,\n    startListening,\n    stopListening,\n    clearMessages,\n  };\n}\n"]}