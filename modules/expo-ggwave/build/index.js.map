{"version":3,"file":"index.js","sourceRoot":"","sources":["../src/index.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,mBAAmB,EAAE,YAAY,EAAE,MAAM,mBAAmB,CAAC;AAEtE,OAAO,EAAE,cAAc,EAAgE,MAAM,oBAAoB,CAAC;AAQlH,2BAA2B;AAC3B,MAAM,gBAAgB,GAAG,mBAAmB,CAAC,YAAY,CAAC,CAAC;AAE3D,MAAM,OAAO,GAAG,IAAI,YAAY,CAAiB,gBAAuB,CAAC,CAAC;AAE1E,MAAM,MAAM;IACF,WAAW,GAAG,KAAK,CAAC;IACpB,MAAM,GAA2B;QACvC,UAAU,EAAE,KAAK;QACjB,QAAQ,EAAE,cAAc,CAAC,YAAY;QACrC,MAAM,EAAE,EAAE;KACX,CAAC;IAEF,KAAK,CAAC,UAAU,CAAC,MAAqB;QACpC,IAAI,MAAM,EAAE,CAAC;YACX,IAAI,CAAC,MAAM,GAAG,EAAE,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,MAAM,EAAE,CAAC;QAC9C,CAAC;QAED,MAAM,gBAAgB,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;QAC1D,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;IAC1B,CAAC;IAED,KAAK,CAAC,QAAQ,CAAC,IAAY,EAAE,QAAyB,EAAE,MAAe;QACrE,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;YACtB,MAAM,IAAI,KAAK,CAAC,kDAAkD,CAAC,CAAC;QACtE,CAAC;QAED,MAAM,WAAW,GAAG,QAAQ,IAAI,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC;QACrD,MAAM,SAAS,GAAG,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;QAE/C,MAAM,QAAQ,GAAG,MAAM,gBAAgB,CAAC,MAAM,CAAC,IAAI,EAAE,WAAW,EAAE,SAAS,CAAC,CAAC;QAC7E,MAAM,gBAAgB,CAAC,YAAY,CAAC,QAAQ,EAAE,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;IACxE,CAAC;IAED,KAAK,CAAC,cAAc,CAAC,QAAgC;QACnD,OAAO,CAAC,GAAG,CAAC,mCAAmC,CAAC,CAAC;QAEjD,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;YACtB,OAAO,CAAC,GAAG,CAAC,oCAAoC,CAAC,CAAC;YAClD,MAAM,IAAI,KAAK,CAAC,kDAAkD,CAAC,CAAC;QACtE,CAAC;QAED,OAAO,CAAC,GAAG,CAAC,0CAA0C,CAAC,CAAC;QACxD,MAAM,YAAY,GAAG,OAAO,CAAC,WAAW,CACtC,gBAAgB,EAChB,CAAC,KAAK,EAAE,EAAE;YACR,OAAO,CAAC,GAAG,CAAC,6BAA6B,EAAE,KAAK,CAAC,CAAC;YAClD,QAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QACvB,CAAC,CACF,CAAC;QAEF,OAAO,CAAC,GAAG,CAAC,8CAA8C,CAAC,CAAC;QAC5D,MAAM,gBAAgB,CAAC,cAAc,EAAE,CAAC;QACxC,OAAO,CAAC,GAAG,CAAC,6CAA6C,CAAC,CAAC;QAE3D,OAAO,YAAY,CAAC;IACtB,CAAC;IAED,KAAK,CAAC,aAAa;QACjB,MAAM,gBAAgB,CAAC,aAAa,EAAE,CAAC;IACzC,CAAC;CACF;AAED,eAAe,IAAI,MAAM,EAAE,CAAC;AAC5B,OAAO,EAAE,cAAc,EAAyC,CAAC;AACjE,cAAc,aAAa,CAAC","sourcesContent":["import { requireNativeModule, EventEmitter } from 'expo-modules-core';\n\nimport { GGWaveProtocol, GGWaveConfig, GGWaveDataReceivedEvent, GGWaveAudioLevelEvent } from './ExpoGGWave.types';\n\n// Define the event map for our module\ntype GGWaveEventMap = {\n  onDataReceived: (event: GGWaveDataReceivedEvent) => void;\n  onAudioLevel: (event: GGWaveAudioLevelEvent) => void;\n};\n\n// Import the native module\nconst ExpoGGWaveModule = requireNativeModule('ExpoGGWave');\n\nconst emitter = new EventEmitter<GGWaveEventMap>(ExpoGGWaveModule as any);\n\nclass GGWave {\n  private initialized = false;\n  private config: Required<GGWaveConfig> = {\n    sampleRate: 48000,\n    protocol: GGWaveProtocol.AUDIBLE_FAST,\n    volume: 50,\n  };\n\n  async initialize(config?: GGWaveConfig): Promise<void> {\n    if (config) {\n      this.config = { ...this.config, ...config };\n    }\n\n    await ExpoGGWaveModule.initialize(this.config.sampleRate);\n    this.initialized = true;\n  }\n\n  async transmit(text: string, protocol?: GGWaveProtocol, volume?: number): Promise<void> {\n    if (!this.initialized) {\n      throw new Error('GGWave not initialized. Call initialize() first.');\n    }\n\n    const useProtocol = protocol ?? this.config.protocol;\n    const useVolume = volume ?? this.config.volume;\n\n    const waveform = await ExpoGGWaveModule.encode(text, useProtocol, useVolume);\n    await ExpoGGWaveModule.playWaveform(waveform, this.config.sampleRate);\n  }\n\n  async startListening(callback: (text: string) => void): Promise<{ remove: () => void }> {\n    console.log('[GGWave JS] startListening called');\n\n    if (!this.initialized) {\n      console.log('[GGWave JS] ERROR: Not initialized');\n      throw new Error('GGWave not initialized. Call initialize() first.');\n    }\n\n    console.log('[GGWave JS] Setting up event listener...');\n    const subscription = emitter.addListener(\n      'onDataReceived',\n      (event) => {\n        console.log('[GGWave JS] Received event:', event);\n        callback(event.text);\n      }\n    );\n\n    console.log('[GGWave JS] Calling native startListening...');\n    await ExpoGGWaveModule.startListening();\n    console.log('[GGWave JS] Native startListening completed');\n\n    return subscription;\n  }\n\n  async stopListening(): Promise<void> {\n    await ExpoGGWaveModule.stopListening();\n  }\n}\n\nexport default new GGWave();\nexport { GGWaveProtocol, GGWaveConfig, GGWaveDataReceivedEvent };\nexport * from './useGGWave';\n"]}